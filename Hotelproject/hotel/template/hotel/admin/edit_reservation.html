{% extends 'hotel/admin/admin_base.html' %}
{% block title %}Edit Reservation - Admin Panel{% endblock %}

{% block admin_content %}
<div class="admin-content-title">
  <h1><i class="fas fa-edit"></i> Edit Reservation</h1>
  <p style="color:var(--muted);margin-top:6px;">
    Update reservation details for offline / walk-in guest.
  </p>
</div>

<div class="admin-card" style="max-width: 900px;">
  <form method="POST" action="{% url 'edit_reservation' reservation.id %}">
    {% csrf_token %}

    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label">Guest</label>
        <select name="guest" class="form-select" required>
          {% for g in guests %}
            <option value="{{ g.id }}"
              {% if reservation.guest.id == g.id %}selected{% endif %}>
              {{ g.user.get_full_name|default:g.user.username }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="col-md-6 mb-3">
        <label class="form-label">Room</label>
        <select name="room" class="form-select" required>
          {% for r in rooms %}
            <option value="{{ r.id }}"
              {% if reservation.room.id == r.id %}selected{% endif %}>
              {{ r.room_number }} â€” {{ r.category.category_name }}
            </option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label">Check-in</label>
        <input type="date" name="check_in_date"
               value="{{ reservation.check_in_date|date:'Y-m-d' }}"
               class="form-control" required>
      </div>

      <div class="col-md-6 mb-3">
        <label class="form-label">Check-out</label>
        <input type="date" name="check_out_date"
               value="{{ reservation.check_out_date|date:'Y-m-d' }}"
               class="form-control" required>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label">Guests</label>
        <input type="number" name="number_of_guests"
               value="{{ reservation.number_of_guests }}"
               min="1" class="form-control">
      </div>

      <div class="col-md-6 mb-3">
        <label class="form-label">Status</label>
        <select name="status" class="form-select">
          {% for key,label in status_choices %}
            <option value="{{ key }}"
              {% if reservation.status == key %}selected{% endif %}>
              {{ key }}
            </option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div style="display:flex; gap:10px; justify-content:flex-end;">
      <a href="{% url 'manage_reservations' %}" class="btn btn-light">Cancel</a>
      <button type="submit" class="btn btn-primary">
        <i class="fas fa-save"></i> Save Changes
      </button>
    </div>
  </form>
</div>
{% endblock %}
