{% extends 'hotel/html/base.html' %}
{% load static %}

{% block title %}Confirm Information - MyHotel{% endblock %}

{% block content %}
<style>
  .confirm-wrap {
    max-width: 900px;
    margin: 60px auto;
    padding: 0 20px;
  }

  .breadcrumb-nav {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 40px;
    font-size: 14px;
  }

  .breadcrumb-step {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #94a3b8;
    font-weight: 600;
  }

  .breadcrumb-step.active {
    color: #0f172a;
    font-weight: 700;
  }

  .breadcrumb-arrow {
    color: #cbd5e1;
    font-size: 12px;
  }

  .page-header {
    margin-bottom: 40px;
  }

  .page-title {
    font-size: 32px;
    font-weight: 900;
    color: #0f172a;
    margin: 0 0 8px 0;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .page-subtitle {
    color: #64748b;
    font-size: 16px;
    font-weight: 600;
  }

  .card {
    background: #fff;
    border: 1px solid #e2e8f0;
    border-radius: 14px;
    padding: 32px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  }

  .form-section {
    margin-bottom: 32px;
  }

  .form-section:last-child {
    margin-bottom: 0;
  }

  .section-title {
    font-size: 18px;
    font-weight: 900;
    color: #0f172a;
    margin: 0 0 20px 0;
    padding-bottom: 12px;
    border-bottom: 2px solid #3b82f6;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .form-row {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
    margin-bottom: 20px;
  }

  .form-row.full {
    grid-template-columns: 1fr;
  }

  .form-group {
    display: flex;
    flex-direction: column;
  }

  .form-label {
    font-weight: 700;
    color: #0f172a;
    margin-bottom: 8px;
    font-size: 14px;
  }

  .form-label .required {
    color: #ef4444;
    margin-left: 4px;
  }

  .form-control {
    padding: 12px 14px;
    border: 1px solid #e2e8f0;
    border-radius: 10px;
    font-size: 14px;
    color: #0f172a;
    background: #fff;
    transition: all 0.2s ease;
  }

  .form-control:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
  }

  .form-text {
    font-size: 12px;
    color: #64748b;
    margin-top: 6px;
  }

  .form-error {
    font-size: 12px;
    color: #ef4444;
    margin-top: 6px;
  }

  .order-summary {
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    border: 1px solid #bfdbfe;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 32px;
  }

  .summary-title {
    font-size: 16px;
    font-weight: 900;
    color: #0f172a;
    margin: 0 0 16px 0;
  }

  .summary-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 14px;
    margin-bottom: 12px;
    padding-bottom: 12px;
    border-bottom: 1px solid #bfdbfe;
  }

  .summary-item:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
  }

  .summary-label {
    color: #64748b;
    font-weight: 600;
  }

  .summary-value {
    color: #0f172a;
    font-weight: 700;
  }

  .summary-total {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 18px;
    font-weight: 900;
    color: #0f172a;
    padding-top: 12px;
    margin-top: 12px;
    border-top: 2px solid #bfdbfe;
  }

  .summary-total .summary-value {
    color: #22c55e;
  }

  .form-actions {
    display: flex;
    gap: 12px;
    margin-top: 32px;
    padding-top: 24px;
    border-top: 1px solid #e2e8f0;
  }

  .btn {
    padding: 14px 24px;
    border: none;
    border-radius: 10px;
    font-weight: 700;
    font-size: 15px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    text-decoration: none;
  }

  .btn-primary {
    background: #3b82f6;
    color: #fff;
    flex: 1;
  }

  .btn-primary:hover {
    background: #2563eb;
    box-shadow: 0 4px 12px rgba(59,130,246,0.3);
  }

  .btn-secondary {
    background: #fff;
    color: #0f172a;
    border: 1px solid #e2e8f0;
  }

  .btn-secondary:hover {
    background: #f8fafc;
    border-color: #cbd5e1;
  }

  .alert {
    padding: 16px;
    border-radius: 10px;
    margin-bottom: 24px;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .alert-info {
    background: #dbeafe;
    color: #1e3a8a;
    border: 1px solid #bfdbfe;
  }

  @media (max-width: 768px) {
    .form-row {
      grid-template-columns: 1fr;
    }

    .confirm-wrap {
      margin: 30px auto;
    }

    .page-title {
      font-size: 24px;
    }
  }
</style>

<div class="confirm-wrap">
  <!-- Breadcrumb Navigation -->
  <div class="breadcrumb-nav">
    <span class="breadcrumb-step">
      <i class="fas fa-shopping-cart"></i> Cart
    </span>
    <span class="breadcrumb-arrow">→</span>
    <span class="breadcrumb-step active">
      <i class="fas fa-clipboard-list"></i> Confirm Info
    </span>
    <span class="breadcrumb-arrow">→</span>
    <span class="breadcrumb-step">
      <i class="fas fa-credit-card"></i> Payment
    </span>
  </div>

  <!-- Page Header -->
  <div class="page-header">
    <h1 class="page-title">
      <i class="fas fa-clipboard-list"></i>
      Confirm Your Information
    </h1>
    <p class="page-subtitle">Please verify your details before proceeding to payment</p>
  </div>

  <!-- Alert -->
  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">
        <i class="fas fa-{% if message.tags == 'success' %}check-circle{% elif message.tags == 'error' or message.tags == 'danger' %}exclamation-circle{% else %}info-circle{% endif %}"></i>
        <span>{{ message }}</span>
      </div>
    {% endfor %}
  {% endif %}

  <div class="card">
    <!-- Order Summary -->
    <div class="order-summary">
      <div class="summary-title">
        <i class="fas fa-shopping-bag" style="color: #3b82f6;"></i>
        Order Summary
      </div>
      {% for item in cart_items %}
        <div class="summary-item">
          <span class="summary-label">
            {% if item.item_type == 'Room' %}
              Room {{ item.room.room_number }}
              <span style="color: #94a3b8; font-weight: 500;">
                ({{ item.check_in_date|date:"M d" }} - {{ item.check_out_date|date:"M d, Y" }})
              </span>
            {% else %}
              {{ item.service.name }}
              {% if item.service_quantity > 1 %}
                <span style="color: #94a3b8; font-weight: 500;"> × {{ item.service_quantity }}</span>
              {% endif %}
            {% endif %}
          </span>
          <span class="summary-value">${{ item.get_item_total|floatformat:2 }}</span>
        </div>
      {% endfor %}
      <div class="summary-total">
        <span>Total Amount</span>
        <span class="summary-value">${{ total_price|floatformat:2 }}</span>
      </div>
    </div>

    <!-- Confirmation Form -->
    <form method="post" novalidate>
      {% csrf_token %}

      <!-- Personal Information Section -->
      <div class="form-section">
        <h2 class="section-title">
          <i class="fas fa-user"></i> Personal Information
        </h2>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">
              Full Name <span class="required">*</span>
            </label>
            <input type="text" name="full_name" class="form-control" 
                   value="{{ full_name }}" required 
                   placeholder="John Doe" />
            <div class="form-text">Your first and last name</div>
            {% if errors.full_name %}
              <div class="form-error">{{ errors.full_name }}</div>
            {% endif %}
          </div>

          <div class="form-group">
            <label class="form-label">
              Email <span class="required">*</span>
            </label>
            <input type="email" name="email" class="form-control" 
                   value="{{ email }}" required 
                   placeholder="john@example.com" />
            <div class="form-text">Used for booking confirmation</div>
            {% if errors.email %}
              <div class="form-error">{{ errors.email }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">
              Phone Number <span class="required">*</span>
            </label>
            <input type="tel" name="phone" class="form-control" 
                   value="{{ phone }}" required 
                   placeholder="+1 (555) 123-4567" />
            <div class="form-text">For hotel communication</div>
            {% if errors.phone %}
              <div class="form-error">{{ errors.phone }}</div>
            {% endif %}
          </div>

          <div class="form-group">
            <label class="form-label">
              Country/Region <span class="required">*</span>
            </label>
            <input type="text" name="country" class="form-control" 
                   value="{{ country }}" required 
                   placeholder="United States" />
            <div class="form-text">Your country of residence</div>
            {% if errors.country %}
              <div class="form-error">{{ errors.country }}</div>
            {% endif %}
          </div>
        </div>
      </div>

      <!-- Address Information Section -->
      <div class="form-section">
        <h2 class="section-title">
          <i class="fas fa-map-pin"></i> Address Information
        </h2>

        <div class="form-row full">
          <div class="form-group">
            <label class="form-label">
              Street Address <span class="required">*</span>
            </label>
            <input type="text" name="address" class="form-control" 
                   value="{{ address }}" required 
                   placeholder="123 Main Street" />
            <div class="form-text">Your street address</div>
            {% if errors.address %}
              <div class="form-error">{{ errors.address }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">
              City <span class="required">*</span>
            </label>
            <input type="text" name="city" class="form-control" 
                   value="{{ city }}" required 
                   placeholder="New York" />
            <div class="form-text">City or town</div>
            {% if errors.city %}
              <div class="form-error">{{ errors.city }}</div>
            {% endif %}
          </div>

          <div class="form-group">
            <label class="form-label">
              State/Province <span class="required">*</span>
            </label>
            <input type="text" name="state" class="form-control" 
                   value="{{ state }}" required 
                   placeholder="NY" />
            <div class="form-text">State, province, or region</div>
            {% if errors.state %}
              <div class="form-error">{{ errors.state }}</div>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">
              ZIP/Postal Code <span class="required">*</span>
            </label>
            <input type="text" name="postal_code" class="form-control" 
                   value="{{ postal_code }}" required 
                   placeholder="10001" />
            <div class="form-text">ZIP or postal code</div>
            {% if errors.postal_code %}
              <div class="form-error">{{ errors.postal_code }}</div>
            {% endif %}
          </div>

          <div class="form-group">
            <label class="form-label">Special Requests (Optional)</label>
            <input type="text" name="special_requests" class="form-control" 
                   value="{{ special_requests }}" 
                   placeholder="e.g., Early check-in, high floor, etc." />
            <div class="form-text">Let us know any special requests</div>
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <a href="{% url 'view_cart' %}" class="btn btn-secondary">
          <i class="fas fa-arrow-left"></i>
          Back to Cart
        </a>
        <button type="submit" class="btn btn-primary">
          <i class="fas fa-credit-card"></i>
          Proceed to Payment
        </button>
      </div>
    </form>
  </div>
</div>

{% endblock %}
